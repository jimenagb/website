<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />




<title>Code</title>

<script src="site_libs/header-attrs-2.24/header-attrs.js"></script>
<script src="site_libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<meta name="viewport" content="width=device-width, initial-scale=1" />
<link href="site_libs/bootstrap-3.3.5/css/bootstrap.min.css" rel="stylesheet" />
<script src="site_libs/bootstrap-3.3.5/js/bootstrap.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/html5shiv.min.js"></script>
<script src="site_libs/bootstrap-3.3.5/shim/respond.min.js"></script>
<style>h1 {font-size: 34px;}
       h1.title {font-size: 38px;}
       h2 {font-size: 30px;}
       h3 {font-size: 24px;}
       h4 {font-size: 18px;}
       h5 {font-size: 16px;}
       h6 {font-size: 12px;}
       code {color: inherit; background-color: rgba(0, 0, 0, 0.04);}
       pre:not([class]) { background-color: white }</style>
<script src="site_libs/jqueryui-1.13.2/jquery-ui.min.js"></script>
<link href="site_libs/tocify-1.9.1/jquery.tocify.css" rel="stylesheet" />
<script src="site_libs/tocify-1.9.1/jquery.tocify.js"></script>
<script src="site_libs/navigation-1.1/tabsets.js"></script>
<link href="site_libs/highlightjs-9.12.0/default.css" rel="stylesheet" />
<script src="site_libs/highlightjs-9.12.0/highlight.js"></script>

<style type="text/css">
  code{white-space: pre-wrap;}
  span.smallcaps{font-variant: small-caps;}
  span.underline{text-decoration: underline;}
  div.column{display: inline-block; vertical-align: top; width: 50%;}
  div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
  ul.task-list{list-style: none;}
    </style>

<style type="text/css">code{white-space: pre;}</style>
<script type="text/javascript">
if (window.hljs) {
  hljs.configure({languages: []});
  hljs.initHighlightingOnLoad();
  if (document.readyState && document.readyState === "complete") {
    window.setTimeout(function() { hljs.initHighlighting(); }, 0);
  }
}
</script>









<style type = "text/css">
.main-container {
  max-width: 940px;
  margin-left: auto;
  margin-right: auto;
}
img {
  max-width:100%;
}
.tabbed-pane {
  padding-top: 12px;
}
.html-widget {
  margin-bottom: 20px;
}
button.code-folding-btn:focus {
  outline: none;
}
summary {
  display: list-item;
}
details > summary > p:only-child {
  display: inline;
}
pre code {
  padding: 0;
}
</style>


<style type="text/css">
.dropdown-submenu {
  position: relative;
}
.dropdown-submenu>.dropdown-menu {
  top: 0;
  left: 100%;
  margin-top: -6px;
  margin-left: -1px;
  border-radius: 0 6px 6px 6px;
}
.dropdown-submenu:hover>.dropdown-menu {
  display: block;
}
.dropdown-submenu>a:after {
  display: block;
  content: " ";
  float: right;
  width: 0;
  height: 0;
  border-color: transparent;
  border-style: solid;
  border-width: 5px 0 5px 5px;
  border-left-color: #cccccc;
  margin-top: 5px;
  margin-right: -10px;
}
.dropdown-submenu:hover>a:after {
  border-left-color: #adb5bd;
}
.dropdown-submenu.pull-left {
  float: none;
}
.dropdown-submenu.pull-left>.dropdown-menu {
  left: -100%;
  margin-left: 10px;
  border-radius: 6px 0 6px 6px;
}
</style>

<script type="text/javascript">
// manage active state of menu based on current page
$(document).ready(function () {
  // active menu anchor
  href = window.location.pathname
  href = href.substr(href.lastIndexOf('/') + 1)
  if (href === "")
    href = "index.html";
  var menuAnchor = $('a[href="' + href + '"]');

  // mark the anchor link active (and if it's in a dropdown, also mark that active)
  var dropdown = menuAnchor.closest('li.dropdown');
  if (window.bootstrap) { // Bootstrap 4+
    menuAnchor.addClass('active');
    dropdown.find('> .dropdown-toggle').addClass('active');
  } else { // Bootstrap 3
    menuAnchor.parent().addClass('active');
    dropdown.addClass('active');
  }

  // Navbar adjustments
  var navHeight = $(".navbar").first().height() + 15;
  var style = document.createElement('style');
  var pt = "padding-top: " + navHeight + "px; ";
  var mt = "margin-top: -" + navHeight + "px; ";
  var css = "";
  // offset scroll position for anchor links (for fixed navbar)
  for (var i = 1; i <= 6; i++) {
    css += ".section h" + i + "{ " + pt + mt + "}\n";
  }
  style.innerHTML = "body {" + pt + "padding-bottom: 40px; }\n" + css;
  document.head.appendChild(style);
});
</script>

<!-- tabsets -->

<style type="text/css">
.tabset-dropdown > .nav-tabs {
  display: inline-table;
  max-height: 500px;
  min-height: 44px;
  overflow-y: auto;
  border: 1px solid #ddd;
  border-radius: 4px;
}

.tabset-dropdown > .nav-tabs > li.active:before, .tabset-dropdown > .nav-tabs.nav-tabs-open:before {
  content: "\e259";
  font-family: 'Glyphicons Halflings';
  display: inline-block;
  padding: 10px;
  border-right: 1px solid #ddd;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li.active:before {
  content: "\e258";
  font-family: 'Glyphicons Halflings';
  border: none;
}

.tabset-dropdown > .nav-tabs > li.active {
  display: block;
}

.tabset-dropdown > .nav-tabs > li > a,
.tabset-dropdown > .nav-tabs > li > a:focus,
.tabset-dropdown > .nav-tabs > li > a:hover {
  border: none;
  display: inline-block;
  border-radius: 4px;
  background-color: transparent;
}

.tabset-dropdown > .nav-tabs.nav-tabs-open > li {
  display: block;
  float: none;
}

.tabset-dropdown > .nav-tabs > li {
  display: none;
}
</style>

<!-- code folding -->



<style type="text/css">

#TOC {
  margin: 25px 0px 20px 0px;
}
@media (max-width: 768px) {
#TOC {
  position: relative;
  width: 100%;
}
}

@media print {
.toc-content {
  /* see https://github.com/w3c/csswg-drafts/issues/4434 */
  float: right;
}
}

.toc-content {
  padding-left: 30px;
  padding-right: 40px;
}

div.main-container {
  max-width: 1200px;
}

div.tocify {
  width: 20%;
  max-width: 260px;
  max-height: 85%;
}

@media (min-width: 768px) and (max-width: 991px) {
  div.tocify {
    width: 25%;
  }
}

@media (max-width: 767px) {
  div.tocify {
    width: 100%;
    max-width: none;
  }
}

.tocify ul, .tocify li {
  line-height: 20px;
}

.tocify-subheader .tocify-item {
  font-size: 0.90em;
}

.tocify .list-group-item {
  border-radius: 0px;
}


</style>



</head>

<body>


<div class="container-fluid main-container">


<!-- setup 3col/9col grid for toc_float and main content  -->
<div class="row">
<div class="col-xs-12 col-sm-4 col-md-3">
<div id="TOC" class="tocify">
</div>
</div>

<div class="toc-content col-xs-12 col-sm-8 col-md-9">




<div class="navbar navbar-default  navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-bs-toggle="collapse" data-target="#navbar" data-bs-target="#navbar">
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <a class="navbar-brand" href="index.html">jimenagb</a>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="index.html">Home</a>
</li>
<li>
  <a href="about.html">About Me</a>
</li>
<li>
  <a href="research.html">Research</a>
</li>
<li>
  <a href="members.html">Members</a>
</li>
<li>
  <a href="teaching.html">Teaching</a>
</li>
<li>
  <a href="Journal.html">Code</a>
</li>
<li>
  <a href="cv.html">CV</a>
</li>
<li>
  <a href="contact.html">Contact</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        
      </ul>
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

<div id="header">



<h1 class="title toc-ignore">Code</h1>

</div>


<p>This is the section of my website where I share R code tutorials and
other useful things.</p>
<div id="intro-to-r-in-15-steps" class="section level1">
<h1>Intro to R in 15 Steps</h1>
<!--# Modified from Workshop Intro to R 2018 co-taught by Dr. Jessica Rick and Dr. Jimena Golcher-Benavides, Last Update: 2023 Jan 17-->
<p>The goal of this tutorial is to introduce you to one of the most
commonly used programming languages in computational biology:
<strong>R</strong>. Throughout this tutorial, you can think of learning
<strong>R</strong> as learning how to use a specialized smartphone, and
learning the specific <strong>R packages</strong> as the various apps
designed to help you do different tasks computational biologists do.</p>
<div id="step-1-create-an-account-with-rstudio-cloud"
class="section level2">
<h2>Step 1: Create an account with RStudio Cloud</h2>
<p><strong>R &amp; R Studio are free!</strong> For this tutorial, I
recommend you use R Studio Cloud. To create a free account just access
this website <em><a href="https://login.rstudio.cloud"
class="uri">https://login.rstudio.cloud</a></em> and create a new
account using your preferred email address.</p>
<div id="step-1b-download-and-install-r-r-studio-alternative"
class="section level3">
<h3>Step 1b: Download and install R + R studio alternative</h3>
<p><strong>R is free and will always be!</strong> If after this
workshop, you would like to go one step further, you can download R by
accessing this website: <em><a href="http://www.r-project.org/"
class="uri">http://www.r-project.org/</a></em> The download link will
take you to a list of CRAN mirrors – pick a mirror: e.g. South Africa
(for a list of the mirrors <em><a
href="https://cran.r-project.org/mirrors.html"
class="uri">https://cran.r-project.org/mirrors.html</a></em>).</p>
<p>Download R studio - free option; <em><a
href="http://www.rstudio.com/ide/download/"
class="uri">http://www.rstudio.com/ide/download/</a></em>.</p>
<p>R studio is composed by <strong>4 panels</strong>:
<strong>1=</strong>Top Left, <strong>2=</strong>Top Right,
<strong>3=</strong>Bottom Left, and <strong>4=</strong>Bottom right.
Note taking happens in <strong>Panel 1</strong>. <strong>Panel
2</strong> has “your environment”, every time you open R, you read data
or create any kind of object in R it will be listed in your
<strong><em>Environment</em></strong> tab. Any code you run in
<strong>Panel 3</strong> will appear also in Panel 2, under
<strong><em>History</em></strong> and anything that you visualize and
more will be in <strong>Panel 4</strong>. We will delve more into the
details soon.</p>
<p><em>You will then need to set your working directory in your local
computer if you chose the option to download R.</em></p>
<p>A working directory is the folder in your computer where all
available data are &amp; results will be saved.To find out the current
working directory, type getwd() and hit ENTER.To set a new working
directory, you will specify the computer path to a folder, for example
<em>setwd(“~/Dropbox/USB”)</em>. You can also use the non-programming
option by following the drop-down menu on R Studio: click on the tab
called <em>Session</em> -&gt; <em>Set Working Directory</em> -&gt;
<em>Choose Directory</em> and just select the folder of your choice in
your computer.</p>
</div>
</div>
<div id="step-2-learn-the-help-command" class="section level2">
<h2>Step 2: Learn the Help Command</h2>
<p><strong><em>Practice makes perfect</em></strong> A way to learn is by
deciphering error messages! So, if you get an error message, which is
the output showing on red font, don’t panic! Computational biologists
are constantly figuring out what error messages mean and why do we get
them. An effective way to do this is to <strong>google</strong> your
error message. Often someone has already found a solution and there is a
ton of help online! Now since we are learning how to code, we can ask R
for help using a specific function in a package by calling in R’s
built-in help function, or by directly typing a question mark before the
function you are trying to use.</p>
<pre class="r"><code>#You want to learn what the function &quot;help()&quot; does in R
?help()
help() </code></pre>
<p><strong><em>Question 1:</em></strong> How would you access built-in
help about the R package <em>dplyr</em>, this is a commonly used package
in data wrangling, management or rearranging (<em><a
href="https://dplyr.tidyverse.org/"
class="uri">https://dplyr.tidyverse.org/</a></em>).<br />
<strong><em>A/</em></strong></p>
</div>
<div id="step-3-do-basic-calculations" class="section level2">
<h2>Step 3: Do basic calculations</h2>
<p>R is like a smartphone, and its built-in package called
<strong>base</strong> can do everything calculators do &amp; much more!
Let’s explore using R as a calculator.</p>
<p>Let’s use R to do some simple calculations:</p>
<pre class="r"><code>#Sum
3 + 3

#Exponential
2^-7

#log function
?log() #add a question mark before a function to learn about what it does.
log(2)</code></pre>
<p><strong><em>Question 2:</em></strong> What type of logarithm
(e.g. natural log, common log-base 10, or binary logarithm) does the log
function computes?<br />
<strong><em>A/</em></strong></p>
<p><strong><em>But then why using R and not a calculator?</em></strong>
In R, anyone can create so called <strong>functions</strong> to create
plots, maps, figures, organize data bases, conduct statistical analyses,
make presentations, build websites, analyze whole genome sequences,
among others.</p>
</div>
<div id="step-4-familiarize-yourself-with-packages-and-versions"
class="section level2">
<h2>Step 4: Familiarize yourself with packages and versions</h2>
<p>Functions are compiled into <strong>packages</strong> (remember to
think of these as the apps in a smartphone) published into the
Comprehensive R Archive Network (CRAN), R’s central software repository
hosted by the R foundation. In March 2022, there were 18,948 R packages
made available through CRAN. (<em><a
href="https://cran.r-project.org/web/packages/"
class="uri">https://cran.r-project.org/web/packages/</a></em>)</p>
<p>When using R or R studio, you can find all the built-in packages
under <strong>Packages</strong> in Panel 4. To search for a specific
package you can select “Install”, this opens a new window in which you
may select the CRAN repository (recommended option) and search the name
of the package by typing the name of it under <strong>Packages (separate
multiple with space or comma)</strong>. Make sure that under “Install to
Library” -&gt; you use the default location to install R packages and
double check that the box for “install dependencies” is ticked. We can
also install packages by coding in the console (<strong>Panel
3</strong>).</p>
<p>For instance search the package called <strong>ggplot2</strong> used
to create elegant graphs/plots using your data. The amount of freely
available tutorials varies a lot among packages, some plotting packages
like ggplot have lots of tutorials online whereas more specific packages
will have sparse info. Yet, almost all packages have a user guide
available online or by simply clicking on the name of the package in
Panel 4, under the <strong>Packages</strong> tab, or the
<strong>help()</strong> function we examined earlier.</p>
<pre class="r"><code>#Example installing packages in R
install.packages(&quot;ggplot2&quot;) #used to create nice plots
install.packages(&quot;dplyr&quot;) #used to do data management
install.packages(&quot;tidyr&quot;) #used to tidy messy data
install.packages(&quot;tibble&quot;) #used together with dplyr to make simple frames
install.packages(&quot;explore&quot;) #used to do exploratory analyses
install.packages(&quot;patchwork&quot;) #creates multiplots / composer of plots
install.packages(&quot;tidyverse&quot;)
library(&quot;tidyverse&quot;)
library(&quot;ggplot2&quot;) #Running the library() command &quot;activates&quot; the packages
library(&quot;dplyr&quot;)
library(&quot;tidyr&quot;)
library(&quot;tibble&quot;)
library(&quot;explore&quot;)
library(&quot;patchwork&quot;)</code></pre>
<p>It will become tricky to manage packages if these require different R
versions (just like some apps in your smartphones that stopped being
supported in old smartphones). It is important to keep the packages you
often need organized and only load those that you will use, to avoid any
problems. Also, since the community is actively developing
<strong>free</strong> packages, there ways to install these are getting
easier and easier.</p>
</div>
<div id="step-5-familiarize-yourself-with-objects-in-r"
class="section level2">
<h2>Step 5: Familiarize yourself with objects in R</h2>
<p>R programming language recognizes a handful of fundamental
<em>units</em> used to perform different actions, we call those
<em>objects</em>. The main types of objects in r are:</p>
<p><strong>Functions:</strong> In R, a function is an object that we
will <em>code</em>. Think of this as a task you want the computer to do
for you. We will use functions by specifying instructions using
<em>arguments</em> (inside of the parentheses) that may be necessary for
the function to accomplish the actions. The basic syntax of a function
can look as simple as this: <em>help()</em> or
<em>log(x,base=y)</em>.</p>
<p><strong>Vectors:</strong> Vectors are variables, or series of values
of the same class, they can be continuous (“numeric”), categorical
(“factor”)“, etc.</p>
<p><strong>Data Frames and Tibbles:</strong> A data frame is a matrix
composed by variables, but formatting variables as a data frame allows
handling versatility in your R studio environment. Many functions
require formatting your data as data frame. We often need to try out
different ways to re-organize our data, so to do this we will take
advantage of a new, simpler and versatile version of the <em>data
frame</em> object called the <em>tibble</em> to be used along with the
package <em>dplyr</em>.</p>
<p><strong>List:</strong> A list can comprise all sorts of object types.
Few functions require data as lists.</p>
<p><strong>Other:</strong> Other less frequently used objects include:
scalars (a single value), matrices (similar to data frame, but allow
objects with varying lengths).</p>
<p>Let’s explore these in R:</p>
<pre class="r"><code>#Object
x &lt;- 3 + 5
x

#Vector
y &lt;- c(1, 2, 3, 4, 5) 
y

seq(1,10, by = 1)#Creates a sequence following specific rules 

vector1&lt;-seq(1, 10,  by = 1)
vector2&lt;-seq(1, 20, by = 2)
vector3&lt;-seq(1, 30,  by = 3)
vector4&lt;-c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;, &quot;D&quot;, &quot;E&quot;, &quot;F&quot;,&quot;G&quot;, &quot;H&quot;, &quot;I&quot;, &quot;J&quot;)

#Data frame
df1&lt;-data.frame(vector1,vector2,vector3, vector4)

#Tibble
tibble1&lt;-tibble::tibble(df1)

#List
list1&lt;- list(df1, vector1, vector2, vector3, vector4, x, y) 

#Note that giving a name (e.g, &quot;df1&quot;) will have downstream implications.
#It is important to give your objects unique, intuitive, short &amp; simple names.</code></pre>
<p><strong><em>Question 3:</em></strong> What is an advantage and a
disadvantage of using a list?<br />
<strong><em>A/</em></strong></p>
</div>
<div id="step-6-familiarize-yourself-with-functions-in-r"
class="section level2">
<h2>Step 6: Familiarize yourself with functions in R</h2>
<p>Here try to find a few more of the many built-in functions in r, for
example:</p>
<pre class="r"><code>#Calculate mean
?mean
mean(vector1)
#Sum values in a vector using
?sum
sum(vector2)

#If we want to build a data frame we *need* to have a set of vectors all of the same length 
#Figure out length of a vector:
length(vector3)
#Retrieve unique values in vector
unique(vector4)
#Sort values in a vector 
df1$vector5&lt;-sort(vector4, decreasing = TRUE)
#Sample 6 values at random from a numeric vector
sample(vector3, 3)
#Sample 4 letters at random from a character vector
sample(vector4, 4)</code></pre>
<p><strong><em>Question 4:</em></strong> How would you modify the
<em>sample()</em> function to sample only three values at random,
allowing a given number or character to appear more than once?<br />
<strong><em>A/</em></strong></p>
<p>You can also use R to plot functions just as most scientific
calculators do. But before coding plots, we will learn a few more R
commands to extract information from data frames or similar objects.</p>
</div>
<div id="step-7-practice-using-data-frames" class="section level2">
<h2>Step 7: Practice using data frames</h2>
<p>Very often we want to summarize, visualize, simulate or analyze
existing data, for that, one can start by using the data frame format in
R. Here we are going to explore functions using very basic data frames,
to learn more about how the data look like.</p>
<p>Note that in R studio, going to <strong>Panel 2</strong> and simply
clicking on a given data frame, will retrieve all its contents in a new
tab in <strong>Panel 1</strong>.</p>
<p><strong><em>Question 5:</em></strong> How would you modify one of
this functions (e.g. <em>mean()</em>) to deal with missing values?<br />
<strong><em>A/</em></strong></p>
</div>
<div id="step-8-practice-exporting-data-frame" class="section level2">
<h2>Step 8: Practice exporting data frame</h2>
<p>If you want to save/export the data frame you created in R, you just
need to call a function named <em>write.csv</em>. To export your data
frame, just name the file. I recommend you save your traditional data
files (aka. <em>excel-like</em> tables) to use in R as a
<strong><em>.csv</em></strong>
(<strong>c</strong>omma-<strong>s</strong>eparated
<strong>v</strong>alues) file format.</p>
<pre class="r"><code>#Exporting data
write.csv(df1, &quot;df_2022jul2.csv&quot;) </code></pre>
<p><strong><em>Question 6:</em></strong> Where is the file saved? Use
the getwd() function to find out. How can you export text or a list that
was created using R?<br />
<strong><em>A/</em></strong></p>
</div>
<div id="step-9-practice-importing-data-in-r" class="section level2">
<h2>Step 9: Practice importing data in R</h2>
<p>Very often we have data that we want to import into R, there are
several formats that are compatible with R. Data tables can be generated
in R or other software, for example: excel, statistical software or
google sheets (free). When data is not generated in R, data, can still
easily be imported but there are distinct ways to import files depending
the format of the data to be imported. Common formats include data as:
text or <em>.txt</em>, comma separated values or
<strong><em>.csv</em></strong> and/or as excel <em>.xlsx</em> (only the
latter requires installing a package called <em>.openxlsx</em>. I
recommend that you always save or import the data as
<strong><em>.csv</em></strong>.</p>
<p>We previouly saved our data as a <em>.csv</em>, to import these data,
we can just use the <strong>read.csv()</strong> function <strong><em>-as
long as the file is contained in our current folder used as working
directory.</em></strong></p>
<pre class="r"><code>#Import data as csv
imported_df1&lt;-read.csv(&quot;df_2022jul2.csv&quot;, header=T)</code></pre>
</div>
<div id="step-10-create-plots" class="section level2">
<h2>Step 10: Create plots</h2>
<p>We can use base R to create quick plots and identify patterns. We
then can export these as a <strong><em>.pdf</em></strong> file format.
Plotting is one of the biggest strengths of R. The possibilities are
unlimited and there is a universe of tutorials out there to show you how
to customize plots. Over the years I have moved on from base R into
using the package <em>ggplot2</em> which we will explore next.</p>
<pre class="r"><code>#First: Plotting with base R
#Plot 1 continuous variable
hist(sample(seq(1:100),200, replace=TRUE), breaks=25, main=&quot;&quot;) #Note Question 7

#Plot 2 continuous variables
plot(df1$Cont1~df1$Cont2)

#Plot 1 continuous variable and 1 Binary/Categorical
boxplot(df1$Cont1~df1$Binary1)

#To export a pdf file with multiple figures:
pdf(&quot;plotsA_2022jul2.pdf&quot;)
hist(sample(seq(1:100),200, replace=TRUE), breaks=25, main=&quot;&quot;)
plot(df1$Cont1~df1$Cont2)
boxplot(df1$Cont1~df1$Binary1)
dev.off()</code></pre>
<p><strong><em>Question 7:</em></strong> What happens when we remove
<em>main=““</em>. How would you go about to rename your y axis
label?<br />
<strong><em>A/</em></strong></p>
<p>Next we will use data on the survival status of individual passengers
on board of the <strong><em>Titanic</em></strong> ship. Visit my google
drive to download the titanic data set <strong>.csv</strong> format:
<em><a
href="https://drive.google.com/file/d/1jhGvXkYSrtsgmEnZ2GBR6AzBy1BUGbNg/view?usp=sharing"
class="uri">https://drive.google.com/file/d/1jhGvXkYSrtsgmEnZ2GBR6AzBy1BUGbNg/view?usp=sharing</a></em></p>
<p>After successfully downloading <em>trains.csv</em> file you would be
able to use the <strong><em>Upload</em></strong> option in <strong>Panel
4</strong>. Simply choose the file to upload, and hit
<strong><em>Ok</em></strong>. Once you do this, it will be available in
your environment.</p>
<p><strong><em>Question 8:</em></strong> Did you get an error trying to
upload this data file? How did you go about to fix this error?<br />
<strong><em>A/</em></strong></p>
<pre class="r"><code>#Import the data set
titanic &lt;- read.csv(&#39;trains.csv&#39;,stringsAsFactors = F, header = T)

#Explore the data set using the functions we learned before
head(titanic) #to see first 10 rows and column names
summary(titanic) #to get a summary of each column
#***Note that R describes missing data as &quot;NA&quot;

#Plot to summarize passenger age with base R
hist(na.omit(titanic$age),col=rainbow(length(1:8)),main=&quot;&quot;,xlab=&quot;age&quot;, ylab=&quot;count&quot;)</code></pre>
</div>
<div id="step-11-practice-using-ggplot2" class="section level2">
<h2>Step 11: Practice using ggplot2</h2>
<p>Base R plots can be modified to look as pretty/detailed as you would
like them to look. However, packages like <strong>ggplot2</strong> make
all the heavy-lifting for you. Next we will learn how to make a few
simple, yet publication-level, <em>nice looking plots</em> using
<strong>ggplot2</strong> and the data management package
<strong>dplyr</strong>. This tutorial does not cover data wrangling
using dplyr, but there are many out there that do!</p>
<p>We just created a simple histogram using base R to use as comparison
with the same plot created using <em>ggplot2</em> and associated
packages.</p>
<pre class="r"><code>#Now let&#39;s use dplyr and ggplot2
#Part 1
#Note how the base R grammar we learned earlier differs a lot from &quot;ggplot2&quot; and &quot;dplyr&quot; (a series of packages as part of the &quot;Tidyverse&quot;) we will use now to visualize the same data:
titanic %&gt;% head(10) #Overview of the first 10 rows
only_1class &lt;- filter(titanic, pclass == &quot;1&quot;) #Extract rows that match a given criteria (like subset() in base R)
countstitanic&lt;- titanic %&gt;% count(sex,pclass,age, sort = TRUE)
widetitanic &lt;- countstitanic %&gt;% spread(sex,n) #Sometimes we want to have a &quot;wide&quot; format
longtitanic &lt;- widetitanic %&gt;% gather(sex, n, female:male, factor_key=TRUE)#this can reverse back to &quot;long&quot;
titanic %&gt;% describe_tbl() #Describes data
summary_titanic&lt;- titanic %&gt;% group_by(sex, pclass) %&gt;%dplyr::summarize(Mean = mean(age, na.rm=TRUE))#Generate summary

#Plot to summarize passenger age with ggplot
p1&lt;-titanic %&gt;% drop_na() %&gt;% ggplot(aes(x=age))+
  geom_histogram(fill=rainbow(length(1:8)),bins=8,show.legend = FALSE)+
  labs(x = &quot;age&quot;)
p1
#Packages like &quot;dplyr&quot; and &quot;ggplot2&quot; do a lot of the hard initial coding/data wrangling for you, giving you more time to focus on more advanced functions to use with your data.</code></pre>
<p>The histogram created using this simple ggplot Rcode is more
attractive, but we can do a lot more to customize this plot. For
instance you can try adding different themes (e.g., classic, bw,
minimal). Simply type <strong><em>theme</em></strong> followed by tab on
the console to learn about the different themes and how to add them to
an existing ggplot.</p>
</div>
<div id="step-12-create-publication-ready-plots-using-ggplot2-and-dplyr"
class="section level2">
<h2>Step 12: Create publication-ready plots using ggplot2 and dplyr</h2>
<pre class="r"><code>#Part 2
#We can combine multiple categorical and continuous variables
p2&lt;-ggplot(data=na.omit(titanic),
           aes(x=factor(sex),y=age,fill=factor(survived)))+
  geom_boxplot()+
  labs(title=&quot;Survival of passengers by sex, age and class&quot;,
       subtitle=&quot;Not everyone had equal chances of surviving&quot;, 
       caption=&quot;Plot by J.Golcher&quot;) +
  xlab(&quot;Passenger class&quot;)+
  ylab(&quot;age&quot;)+
  facet_wrap(~factor(pclass))+
  scale_fill_manual(values=c(&quot;mediumvioletred&quot;,&quot;cornflowerblue&quot;),
                    name=&quot;&quot;,breaks=c(&quot;0&quot;, &quot;1&quot;),labels=c(&quot;died&quot;, &quot;survived&quot;))+
  theme(plot.title = element_text(face = &quot;bold&quot;))

p2</code></pre>
<p>Using ggplot, we can quickly make clear figures that help data
interpretation. Multiple data visualization R tutorials and cheat sheets
exist in the internet. If you are interested in how to go from beginner
to pro, again <strong><em>practice makes perfect</em></strong>. There
are also new packages that make it easier to explore patterns from data,
one of them is the package <strong><em>explore</em></strong>. This part
of the tutorial is adapted from a 2022 tutorial written by Roland
Crasser that can be accessed here: <em><a
href="https://cran.r-project.org/web/packages/explore/vignettes/explore_titanic.html"
class="uri">https://cran.r-project.org/web/packages/explore/vignettes/explore_titanic.html</a></em></p>
<pre class="r"><code>#Part 3
#Let&#39;s explore functions and plots in explore
#
#First let&#39;s make age a categorical variable:
titanic$age_cat &lt;- cut(titanic$age,breaks=c(0,19,60,90),
                       labels=c(&quot;children&quot;,&quot;adult&quot;,&quot;senior&quot;))

#This is perhaps unnecessary but just to be sure
titanic2 &lt;- tibble(titanic) #data frame into tibble

#We would like to reorganize our data as counts per categories
titan_sum&lt;-titanic2 %&gt;% group_by(pclass, survived,age_cat,sex) %&gt;% dplyr::count()

titan_sum %&gt;% describe_tbl(n=n) #describes data and NA

#Creating plots using explore
p3&lt;-titan_sum %&gt;% explore(age_cat, n = n) #passenger class distrib.
p4&lt;-titan_sum %&gt;% explore(age_cat, target = survived, n = n)
p5&lt;-titan_sum %&gt;% explore_all(n = n) #To see counts for all vars.
p6&lt;-titan_sum %&gt;% explore_all(target = survived, n = n, split = TRUE)

p3
p4
p5
p6</code></pre>
</div>
<div id="step-13-export-ggplot2-charts" class="section level2">
<h2>Step 13: Export ggplot2 charts</h2>
<p>In this example we went beyond simply plotting using base R to
practice data re-organization with advanced visualization. Lastly we
will learn how to arrange and export ggplot figures using the package
<em>patchwork</em>.</p>
<pre class="r"><code>#Part 4
#A package to save ggplots
library(patchwork)
p&lt;-(p1)/(p2)
#Save plots
ggsave(&quot;plotsB_2023jan17.pdf&quot;, p)</code></pre>
<p><strong><em>Question 9:</em></strong> How would you modify this code
to save the plots next to one another using <em>patchwork</em> (instead
of one on top ot the other).<br />
<strong><em>A/</em></strong></p>
<p>Now we have explored how to make a few plots using base R and some of
the newest plotting options available associated to the package
<em>ggplot2</em>. Still, remember that this is the very tiny tip of the
iceberg. It will be up to you to take it from here and make significant
progress in your R journey coding and making plots. There are almost too
many resources online to learn how to visualize data using R, but as a
start visit: <em><a href="https://www.r-graph-gallery.com/"
class="uri">https://www.r-graph-gallery.com/</a></em> to get inspired
with a gallery of different types of charts.</p>
</div>
<div id="step-14-run-a-simple-statistical-test" class="section level2">
<h2>Step 14: Run a simple statistical test</h2>
<p>As a biologist, one of the first statistical tests we learn is how to
calculate a Chi-squared value. For instance, such tests are used in the
context of transmission genetics, together with the Chi-squared value
distribution table to test for significance rejecting a null hypothesis
of observations deviating or not from expected. As you already guessed
it, R can do this for you and much more. We will start by learning how
to do this test using the console, and review how to interpret results
of the <em>chisq.test()</em> function in base R using the Titanic toy
data set.</p>
<p><strong><em>Question 10:</em></strong> What would be
<strong>1)</strong> the null and <strong>2)</strong> the alternative
hypotheses for a Chi-squared test looking at passenger survival by
class? After running the code below: <strong>3)</strong> Was the p-value
significant? <strong>4)</strong> What does this mean?<br />
<strong><em>A/</em></strong></p>
<pre class="r"><code>#Chi-squared test using R
res1&lt;-chisq.test(titanic$pclass, titanic$survived)
res1
res1$observed
res1$expected</code></pre>
</div>
<div id="step-15-cite-r-and-rpackages" class="section level2">
<h2>Step 15: Cite R and Rpackages</h2>
<p>It is key to give credit to the generous people who develop packages
for free, often with public funds from universities and other research
institutions. Providing authors with the credit they deserve also
encourages funding agencies to support their work, which ultimately
benefits the entire community of R users.</p>
<pre class="r"><code>citation() #To cite R
R.Version() #Figure out R version
RStudio.Version() #To cite R studio
#To cite all the packages  used in this tutorial:
citation(&quot;ggplot2&quot;)
citation(&quot;dplyr&quot;)
citation(&quot;tibble&quot;)
citation(&quot;explore&quot;)
citation(&quot;patchwork&quot;)</code></pre>
<p><em>This mini-workshop was modified from the 2018 Workshop notes
Intro to R for fisheries researchers in Tanzania co-taught by
Dr. Jessica Rick and Dr. Jimena Golcher-Benavides. I would like to thank
the generous R &amp; R learning community for all the high-quality
learning resources freely available online.</em></p>
<p>For more learning resources on how to use R &amp; R Studio, check out
these guidelines written by Thomas Mock: <em><a
href="https://www.rstudio.com/resources/webinars/a-gentle-introduction-to-tidy-statistics-in-r/"
class="uri">https://www.rstudio.com/resources/webinars/a-gentle-introduction-to-tidy-statistics-in-r/</a></em>.</p>
</div>
</div>
<div id="other-useful-code" class="section level1">
<h1>Other useful code</h1>
<p>I will include here other useful R tutorials or R code in the near
future <em>Come</em> <em>back</em> <em>soon</em>.</p>
</div>



</div>
</div>

</div>

<script>

// add bootstrap table styles to pandoc tables
function bootstrapStylePandocTables() {
  $('tr.odd').parent('tbody').parent('table').addClass('table table-condensed');
}
$(document).ready(function () {
  bootstrapStylePandocTables();
});


</script>

<!-- tabsets -->

<script>
$(document).ready(function () {
  window.buildTabsets("TOC");
});

$(document).ready(function () {
  $('.tabset-dropdown > .nav-tabs > li').click(function () {
    $(this).parent().toggleClass('nav-tabs-open');
  });
});
</script>

<!-- code folding -->

<script>
$(document).ready(function ()  {

    // temporarily add toc-ignore selector to headers for the consistency with Pandoc
    $('.unlisted.unnumbered').addClass('toc-ignore')

    // move toc-ignore selectors from section div to header
    $('div.section.toc-ignore')
        .removeClass('toc-ignore')
        .children('h1,h2,h3,h4,h5').addClass('toc-ignore');

    // establish options
    var options = {
      selectors: "h1",
      theme: "bootstrap3",
      context: '.toc-content',
      hashGenerator: function (text) {
        return text.replace(/[.\\/?&!#<>]/g, '').replace(/\s/g, '_');
      },
      ignoreSelector: ".toc-ignore",
      scrollTo: 0
    };
    options.showAndHide = true;
    options.smoothScroll = true;

    // tocify
    var toc = $("#TOC").tocify(options).data("toc-tocify");
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
